"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var chartInstance=null;function fetchStockData(t){var n,r,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return"W69SKYDC7J7YHF46",n="https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=".concat(t,"&apikey=").concat("W69SKYDC7J7YHF46"),e.prev=2,e.next=5,regeneratorRuntime.awrap(fetch(n));case 5:if(429===(r=e.sent).status)throw new Error("Rate limit exceeded. Please wait and try again.");e.next=8;break;case 8:return e.next=10,regeneratorRuntime.awrap(r.json());case 10:if(a=e.sent,console.log("Fetched stock data:",a),a["Time Series (Daily)"])return e.abrupt("return",a["Time Series (Daily)"]);e.next=16;break;case 16:throw new Error(a.Note||"Failed to retrieve data");case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(2),console.error("Error fetching stock data:",e.t0),e.t0;case 23:case"end":return e.stop()}},null,null,[[2,19]])}function predictStockPricesWithChatGPT(t,n){var r,a,o,c,l,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return"sk-proj-5juprBo9dw9wdpOq5opJT3BlbkFJA2aOYGK54Ia0Udb3rSXM","https://api.openai.com/v1/chat/completions",r=Object.values(n).map(function(e){return parseFloat(e["4. close"])}).reverse(),a="Given the following closing prices for stock ".concat(t,": ").concat(r.join(", "),", predict the next 7 days of closing prices. Please provide the prices as a comma-separated list."),console.log("Prompt for GPT-3:",a),e.prev=5,e.next=8,regeneratorRuntime.awrap(fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("sk-proj-5juprBo9dw9wdpOq5opJT3BlbkFJA2aOYGK54Ia0Udb3rSXM")},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:a}],max_tokens:100,temperature:.5})}));case 8:return o=e.sent,e.next=11,regeneratorRuntime.awrap(o.json());case 11:if(c=e.sent,console.log("GPT-3 response:",c),c.choices&&0<c.choices.length)return l=c.choices[0].message.content.trim(),s=l.split(",").map(function(e){return parseFloat(e.trim())}),console.log("Predictions:",s),e.abrupt("return",s);e.next=20;break;case 20:throw new Error("Invalid GPT-3 response");case 21:e.next=27;break;case 23:throw e.prev=23,e.t0=e.catch(5),console.error("Error predicting stock prices with ChatGPT:",e.t0),e.t0;case 27:case"end":return e.stop()}},null,null,[[5,23]])}function predictStockPrices(t){var n,r,a,o,c,l,s,i,d;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("loading"),r=document.getElementById("error"),document.getElementById("result"),a=document.querySelector("#priceTable tbody"),o=document.getElementById("viewToggle"),c=document.getElementById("chartView"),l=document.getElementById("tableView"),s=document.getElementById("backButtonContainer"),n.style.display="block",r.style.display="none",a.innerHTML="",c.style.display="none",l.style.display="none",o.style.display="none",s.style.display="none",e.prev=15,e.next=18,regeneratorRuntime.awrap(fetchStockData(t));case 18:if(i=e.sent)return e.next=22,regeneratorRuntime.awrap(predictStockPricesWithChatGPT(t,i));e.next=26;break;case 22:(d=e.sent)?(displayChart(i,d),displayTable(i,d),c.style.display="block",o.style.display="block",s.style.display="block"):(r.textContent="Failed to get predictions",r.style.display="block"),e.next=28;break;case 26:r.textContent="Failed to fetch stock data",r.style.display="block";case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(15),r.textContent=e.t0.message,r.style.display="block";case 34:return e.prev=34,n.style.display="none",e.finish(34);case 37:case"end":return e.stop()}},null,null,[[15,30,34,37]])}function displayChart(e,t){var n=Object.values(e).map(function(e){return parseFloat(e["4. close"])}).reverse(),r=Object.keys(e).reverse(),a=Array(7).fill("").map(function(e,t){return"Day ".concat(t+1)}),o=document.getElementById("myChart").getContext("2d");chartInstance&&chartInstance.destroy(),chartInstance=new Chart(o,{type:"line",data:{labels:[].concat(_toConsumableArray(r),_toConsumableArray(a)),datasets:[{label:"Historical Prices",data:n,borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,fill:!1},{label:"Predicted Prices",data:[].concat(_toConsumableArray(Array(n.length).fill(null)),_toConsumableArray(t)),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1,fill:!1}]},options:{scales:{x:{display:!0,title:{display:!0,text:"Date"}},y:{display:!0,title:{display:!0,text:"Price"}}}}})}function displayTable(e,t){var o=Object.values(e).map(function(e){return parseFloat(e["4. close"])}).reverse(),n=Object.keys(e).reverse(),c=document.querySelector("#priceTable tbody"),r=document.getElementById("tableView");n.forEach(function(e,t){var n=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td");r.textContent=e,a.textContent=o[t],n.appendChild(r),n.appendChild(a),c.appendChild(n)}),t.forEach(function(e,t){var n=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td");r.textContent="Day ".concat(t+1),a.textContent=e,n.appendChild(r),n.appendChild(a),c.appendChild(n)}),r.style.display="none"}function toggleView(){var e=document.getElementById("chartView"),t=document.getElementById("tableView"),n=document.getElementById("toggleViewButton");"none"===e.style.display?(e.style.display="block",t.style.display="none",n.textContent="Switch to Table View"):(e.style.display="none",t.style.display="block",n.textContent="Switch to Chart View")}function resetForm(){var e=document.getElementById("stockSymbol"),t=document.getElementById("chartView"),n=document.getElementById("tableView"),r=document.getElementById("viewToggle"),a=document.getElementById("backButtonContainer"),o=document.querySelector("#priceTable tbody");e.value="",t.style.display="none",n.style.display="none",r.style.display="none",a.style.display="none",o.innerHTML="",chartInstance&&(chartInstance.destroy(),chartInstance=null)}document.getElementById("predictButton").addEventListener("click",function(){predictStockPrices(document.getElementById("stockSymbol").value)}),document.getElementById("toggleViewButton").addEventListener("click",toggleView),document.getElementById("backButton").addEventListener("click",resetForm);
//# sourceMappingURL=script.min.js.map
